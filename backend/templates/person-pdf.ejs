<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title><%= person.name %> - Profile</title>
  <style>
    @page { size: A4; margin: 0; }
    html,body { margin:0; padding:0; font-family: "Helvetica", Arial, sans-serif; color: #111; -webkit-print-color-adjust: exact; }
    .page { box-sizing: border-box; padding: 110px 40px 110px 40px; }

    header {
      position: fixed; top: 0; left: 0; right: 0;
      height: 90px; padding: 12px 40px;
      border-bottom: 1px solid #ddd;
      display:flex; align-items:center; justify-content:space-between;
      background: #fff;
    }
    .header-left { display:flex; gap:16px; align-items:center; }
    .logo { height:64px; width:auto; object-fit:contain; }
    .company-meta { font-size:12px; line-height:1.1; color:#333; }
    .header-right { text-align:right; font-size:12px; }

    footer {
      position: fixed; bottom: 0; left: 0; right: 0;
      height: 90px; padding: 12px 40px;
      border-top: 1px solid #ddd; font-size:11px; color:#444; background:#fff;
    }

    h1.title { font-size:20px; margin:0 0 12px 0; letter-spacing:0.5px; }
    .profile-top { display:flex; gap:18px; margin-bottom:18px; }
    .profile-pic {
      width:180px; height:220px; object-fit:cover;
      border-radius:4px; border:1px solid #ccc;
    }
    .personal-details { flex:1; }
    .detail-row { display:flex; gap:12px; margin-bottom:6px; }
    .label { width:180px; font-weight:600; color:#222; }
    .value { flex:1; }

    .section { margin-top:10px; page-break-inside: avoid; }
    .section h2 { font-size:14px; margin:8px 0; border-bottom:1px solid #eee; padding-bottom:6px; }
    .family-table, .siblings-table { width:100%; border-collapse: collapse; margin-top:6px; }
    .family-table td, .siblings-table td { padding:6px 8px; border:1px solid #e8e8e8; vertical-align:top; font-size:13px; }

    .disclaimer { font-size:11px; color:#666; margin-top:14px; line-height:1.25; }

    /* Full-page photo styling */
    .photo-page { page-break-before: always; text-align: center; }
    .photo-page img { max-width: 100%; max-height: 95vh; object-fit: contain; }
  </style>
</head>
<body>
  <header>
    <div class="header-left">
      <img src="<%= logoUrl %>" class="logo" alt="logo" />
      <div class="company-meta">
        <strong><%= companyName %></strong><br/>
        <span><%= companyContact %></span><br/>
        <small><%= companyAddress %></small>
      </div>
    </div>
    <div class="header-right">
      <small>Profile Detail</small><br/>
      <small><%= generatedAt.toLocaleString() %></small>
    </div>
  </header>

  <div class="page">
    <h1 class="title">Profile Detail</h1>

    <div class="profile-top">
      <% if (person.photos && person.photos.length) { %>
        <img src="<%= person.photos[0] %>" alt="Profile Picture" class="profile-pic" />
      <% } else { %>
        <img src="/assets/no-photo.png" alt="no photo" class="profile-pic" />
      <% } %>

      <div class="personal-details">
        <div class="detail-row"><div class="label">Name :</div><div class="value"><%= person.name || "" %></div></div>
        <div class="detail-row"><div class="label">Gender :</div><div class="value"><%= person.gender || "" %></div></div>
        <div class="detail-row"><div class="label">Marital Status :</div><div class="value"><%= person.maritalStatus || "" %></div></div>
        <div class="detail-row"><div class="label">Date Of Birth :</div><div class="value"><%= person.dob || "" %></div></div>
        <div class="detail-row"><div class="label">Native Place :</div><div class="value"><%= person.nativePlace || "" %></div></div>
        <div class="detail-row"><div class="label">Height :</div><div class="value"><%= person.height || "" %></div></div>
        <div class="detail-row"><div class="label">Complexion :</div><div class="value"><%= person.complexion || "" %></div></div>
        <div class="detail-row"><div class="label">Eating Habits :</div><div class="value"><%= person.eatingHabits || "" %></div></div>
        <div class="detail-row"><div class="label">NRI :</div><div class="value"><%= person.nri ? "Yes" : "No" %></div></div>
      </div>
    </div>

    <div class="section">
      <h2>Educational & Profession</h2>
      <div class="detail-row"><div class="label">Higher Qualification :</div><div class="value"><%= person.education || "" %></div></div>
      <div class="detail-row"><div class="label">Occupation :</div><div class="value"><%= person.occupation || "" %></div></div>
      <div class="detail-row"><div class="label">Personal Income :</div><div class="value"><%= person.income || "" %></div></div>
      <div class="detail-row"><div class="label">Residence :</div><div class="value"><%= person.residence || "" %></div></div>
    </div>

    <div class="section">
      <h2>Family Details</h2>
      <table class="family-table">
        <tr>
          <td><strong>Father</strong></td><td><%= person.family?.father || "" %></td>
          <td><strong>Mother</strong></td><td><%= person.family?.mother || "" %></td>
        </tr>
        <tr>
          <td><strong>Family Income</strong></td><td><%= person.familyIncome || "" %></td>
          <td><strong>Other Property</strong></td><td><%= person.otherProperty || "" %></td>
        </tr>
      </table>
    </div>

    <div class="section">
      <h2>Siblings & Extended Family</h2>
      <table class="siblings-table">
        <thead>
          <tr><td><strong>Name</strong></td><td><strong>Relation</strong></td><td><strong>Age</strong></td><td><strong>Profession</strong></td><td><strong>Marital Status</strong></td></tr>
        </thead>
        <tbody>
          <% if (person.siblings && person.siblings.length) { %>
            <% person.siblings.forEach(function(sib){ %>
              <tr>
                <td><%= sib.name %></td>
                <td><%= sib.relation %></td>
                <td><%= sib.age %></td>
                <td><%= sib.profession %></td>
                <td><%= sib.maritalStatus %></td>
              </tr>
            <% }) %>
          <% } else { %>
            <tr><td colspan="5">No sibling details</td></tr>
          <% } %>
        </tbody>
      </table>
    </div>

    <div class="disclaimer">
      <strong>NOTE :</strong> The above particulars have been provided to the best of our knowledge, as per information provided by the concerned party. We shall not be responsible for misrepresentation of any information here in. Amount will not be refunded in any case. All clients have to pay full maturity amount on ROKA CEREMONY.
    </div>
  </div>

  <!-- Extra photos as separate pages -->
  <% if (person.photos && person.photos.length > 1) { 
       for (let i = 1; i < person.photos.length; i++) { %>
    <div class="photo-page">
      <img src="<%= person.photos[i] %>" alt="Photo <%= i+1 %>" />
    </div>
  <% } } %>

  <footer>
    <div style="display:flex;justify-content:space-between;align-items:center;">
      <div>
        <strong><%= companyName %></strong><br/>
        <small><%= companyContact %> | <%= companyAddress %></small>
      </div>
      <div style="text-align:right;">
        <small>By Mamta Aggarwal, 9871080409, 9211729184, 9211729185, 9211729186</small><br/>
        <small>www.jodino1@gmail.com</small>
      </div>
    </div>
  </footer>
</body>
</html>
